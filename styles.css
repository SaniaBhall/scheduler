:root{
  /* App palette */
  --app-muted: #a8b0c2;
  --app-primary: #8b5cf6;  /* violet */
  --app-primary-2: #22d3ee;/* cyan */
  --app-danger: #ff5d5d;
  --app-ok: #3ccf91;
  --app-warn: #ffcc66;
  --app-shadow: 0 10px 30px rgba(0,0,0,.35);
  --app-radius: 14px;
  --app-surface: #ffffff;
  --text: #0f172a;
  --bg: #f7f9ff;

  /* Topbar overrides (from shared topbar.css) */
  --topbar-bg: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.86));
  --topbar-text: #0f172a;
  --topbar-accent: var(--app-primary);
  --logo-height: 32px;
  --ring-pending: #ffcc66;
  --ring-bg: #e5e7eb; /* light grey when no tasks */
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 600px at 15% -10%, color-mix(in oklab, var(--app-primary), transparent 92%), transparent 60%),
    radial-gradient(1000px 500px at 85% 110%, color-mix(in oklab, var(--app-primary-2), transparent 92%), transparent 60%),
    linear-gradient(180deg, #ffffff, #f7f9ff);
  color:var(--text, #0f172a);
  font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif
}

/* Topbar tweaks */
.topbar { position: sticky; top: 0; z-index: 20; backdrop-filter: saturate(1.3) blur(6px); }
.app-brand { display:flex; align-items:center; gap:10px; }
.app-logo { display:inline-flex; align-items:center; justify-content:center; width:36px; height:36px; border-radius:10px; background: color-mix(in oklab, var(--app-primary), transparent 85%); box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--app-primary), transparent 55%); }
.app-mark { filter: drop-shadow(0 1px 6px rgba(0,0,0,.25)); }
.app-name { letter-spacing:.2px; }

.container{max-width:min(1400px,96vw);margin:0 auto;padding:24px clamp(16px,3vw,40px)}

/* Layout grid for content sections */
.main-grid{display:grid;grid-template-columns:380px 1fr;gap:20px;align-items:stretch}
@media (max-width: 980px){ .main-grid{grid-template-columns:1fr} }

.card{background:linear-gradient(180deg, color-mix(in oklab, var(--app-surface, #ffffff), black 2%), var(--app-surface, #ffffff));
  border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 10%);
  box-shadow:var(--app-shadow);border-radius:var(--app-radius);padding:20px;margin:18px 0}

/* Completion celebration effect on Add Task card */
#add-card.add-celebrate{animation: add-celebrate 1200ms ease; box-shadow: 0 12px 50px color-mix(in oklab, var(--app-primary), transparent 70%), var(--app-shadow)}
@keyframes add-celebrate {
  0% { transform: translateZ(0) scale(1); }
  30% { transform: translateZ(0) scale(1.01); }
  60% { transform: translateZ(0) scale(1.015); }
  100% { transform: translateZ(0) scale(1); }
}
/* Always-on subtle pulse for Add Task card */
#add-card{animation: breathe 6s ease-in-out infinite}
@keyframes breathe{ 0%{box-shadow:var(--app-shadow)} 50%{box-shadow:0 18px 60px rgba(139,92,246,.18), var(--app-shadow)} 100%{box-shadow:var(--app-shadow)} }

/* History */
.history-groups{display:grid;gap:14px}
.hist-day{border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 10%);border-radius:12px;padding:10px 12px}
.hist-day-title{display:flex;align-items:center;justify-content:space-between;margin:0 0 8px 0;font-size:.95rem;color:var(--app-muted)}
.hist-list{list-style:none;margin:0;padding:0 0 0 22px;display:grid;gap:8px;position:relative}
.hist-list::before{content:"";position:absolute;left:11px;top:0;bottom:0;width:2px;background:linear-gradient(180deg, color-mix(in oklab, var(--app-primary), transparent 40%), color-mix(in oklab, var(--app-primary-2), transparent 40%))}
.hist-item{position:relative;padding:8px 8px 8px 8px;border-radius:10px;background:color-mix(in oklab, var(--app-surface, #ffffff), black 2%);border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 10%)}
.hist-item::before{content:"";position:absolute;left:-15px;top:16px;width:10px;height:10px;border-radius:50%;background:var(--app-primary)}

.hero{display:flex;gap:24px;align-items:center;justify-content:space-between;flex-wrap:wrap}
.hero h2{margin:0 0 6px}
.hero .subtle{margin:0;color:var(--app-muted)}
.day-banner{font-size:clamp(20px,3.2vw,28px);font-weight:800;letter-spacing:.2px;
  background:linear-gradient(90deg,var(--app-primary),var(--app-primary-2));
  -webkit-background-clip:text;background-clip:text;color:transparent;margin-bottom:6px;
  background-size:200% 100%; animation: shine 12s linear infinite}
.shine-text{background:linear-gradient(90deg,var(--app-primary),var(--app-primary-2));-webkit-background-clip:text;background-clip:text;color:transparent;background-size:200% 100%;animation: shine 16s linear infinite}
.section-title{color:var(--text,#0f172a)}
@keyframes shine{0%{background-position:0% 50%}100%{background-position:200% 50%}}
.date-picker{margin-top:12px}
.label{display:block;color:var(--app-muted);font-size:.9rem;margin-bottom:6px}

.progress{display:flex;align-items:center;gap:12px}
.progress-ring{position:relative;width:120px;height:120px}
.ring-bg{fill:none;stroke:var(--ring-bg, #e5e7eb);stroke-width:12}
.ring-fg{fill:none;stroke:var(--ring-color, var(--app-primary));stroke-width:12;stroke-linecap:round;transform:rotate(-90deg);transform-origin:50% 50%;
  stroke-dasharray: 326.72; /* 2 * PI * r (r=52) */
  stroke-dashoffset: 326.72;
  transition: stroke-dashoffset .6s ease}
.progress-text{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;font-weight:800;color:#0f172a}
.progress-denom{color:var(--app-muted);font-weight:500}

.task-form{display:grid;gap:10px}
.field input,.field textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 12%);
  background:color-mix(in oklab, var(--app-surface, #ffffff), black 2%);color:var(--text, #0f172a);outline:none}
.field input:focus,.field textarea:focus{border-color:var(--app-primary);box-shadow:0 0 0 3px color-mix(in oklab, var(--app-primary), transparent 80%)}
.field-hint{color:var(--app-muted);font-size:.85rem;margin-top:2px;margin-bottom:0}
.field-error{color:var(--app-danger);font-size:.85rem;margin-top:6px;min-height:1em}
.field.two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.actions{display:flex;gap:12px}

.btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 12%);border-radius:12px;padding:10px 14px;background:color-mix(in oklab, var(--app-surface, #ffffff), black 2%);
  color:var(--text, #0f172a);cursor:pointer;transition:transform .05s ease, background .2s ease}
.btn:hover{background:color-mix(in oklab, var(--app-surface, #ffffff), black 6%)}
.btn:active{transform:translateY(1px)}
.btn.primary{background:linear-gradient(180deg, var(--app-primary), var(--app-primary-2));color:white}
.btn.primary:hover{filter:brightness(1.05)}
.btn.danger{background:linear-gradient(180deg, #ff6b6b, #ff4d4d);color:white}
.btn-small{padding:6px 10px;border-radius:10px}

/* Unify all button-like styles */
.chip-btn,.icon-btn,.btn{border-radius:999px}
.chip-btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);background:color-mix(in oklab, var(--app-surface,#fff), black 2%);color:var(--text,#0f172a);padding:8px 12px;cursor:pointer;transition:box-shadow .2s ease, transform .06s ease}
.chip-btn:hover,.icon-btn:hover,.btn:hover{box-shadow:0 6px 18px rgba(0,0,0,.08)}
.chip-btn:active,.icon-btn:active,.btn:active{transform:translateY(1px)}
.chip-btn.active{border-color: color-mix(in oklab, var(--app-primary), transparent 40%); box-shadow: 0 0 0 3px color-mix(in oklab, var(--app-primary), transparent 80%), 0 10px 28px rgba(139,92,246,.18)}
.icon-btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 12%);background:color-mix(in oklab, var(--app-surface, #ffffff), black 2%);padding:6px 10px}

/* Shine effect for Complete All */
.btn-shine{position:relative;overflow:hidden}
.btn-shine::after{content:"";position:absolute;inset:-1px;background:linear-gradient(90deg, rgba(139,92,246,.25), rgba(34,211,238,.25));filter:blur(18px);opacity:.0;transition:opacity .3s ease}
.btn-shine:hover::after{opacity:.9}

/* Apply similar shine to all buttons */
.btn, .chip-btn, .icon-btn{position:relative;overflow:hidden}
.btn::after, .chip-btn::after, .icon-btn::after{content:"";position:absolute;inset:-1px;background:linear-gradient(90deg, rgba(139,92,246,.12), rgba(34,211,238,.12));filter:blur(14px);opacity:0;transition:opacity .25s ease;pointer-events:none}
.btn:hover::after, .chip-btn:hover::after, .icon-btn:hover::after{opacity:.85}

.list-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:6px}
.sub-title{margin:8px 0 10px 0;color:var(--app-muted);font-size:.95rem;font-weight:600}
.list-controls{display:flex;gap:10px}
.filters{display:flex;gap:8px;align-items:center}
.chip-btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);background:color-mix(in oklab, var(--app-surface,#fff), black 2%);color:var(--text,#0f172a);padding:8px 12px;border-radius:999px;cursor:pointer;transition:box-shadow .2s ease, transform .06s ease}
.chip-btn:hover{box-shadow:0 6px 18px rgba(0,0,0,.08)}
.chip-btn:active{transform:translateY(1px)}
.chip-btn.active{border-color: color-mix(in oklab, var(--app-primary), transparent 40%); box-shadow: 0 0 0 3px color-mix(in oklab, var(--app-primary), transparent 80%), 0 10px 28px rgba(139,92,246,.18)}

.empty-state{padding:14px;border:1px dashed color-mix(in oklab, var(--app-surface, #ffffff), black 14%);border-radius:12px;color:var(--app-muted);text-align:center}

.task-list{list-style:none;margin:0;padding:0 0 0 22px;display:grid;gap:12px;position:relative}
.task-list::before{content:"";position:absolute;left:11px;top:0;bottom:0;width:2px;background:linear-gradient(180deg, color-mix(in oklab, var(--app-primary), transparent 40%), color-mix(in oklab, var(--app-primary-2), transparent 40%))}
.task{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:12px;padding:12px;border-radius:12px;border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 10%);
  background:linear-gradient(180deg, color-mix(in oklab, var(--app-surface, #ffffff), black 1.5%), color-mix(in oklab, var(--app-surface, #ffffff), black 3%));
  border-left:4px solid transparent}
.task{overflow:visible}
.task::before{content:"";position:absolute;left:-15px;top:22px;width:10px;height:10px;border-radius:50%;background:var(--app-primary);box-shadow:0 0 0 6px color-mix(in oklab, var(--app-primary), transparent 85%)}
.task{position:relative}
.task:hover{transform:translateY(-1px);box-shadow:0 8px 22px rgba(0,0,0,.06)}
.task-time{font-variant-numeric:tabular-nums;color:var(--app-muted);min-width:120px}
.task-title{font-weight:600}
.task-notes{color:var(--app-muted);font-size:.9rem}
.task-actions{display:flex;gap:8px}
.icon-btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface, #ffffff), black 12%);background:transparent;border-radius:10px;padding:6px 10px;cursor:pointer}
.icon-btn:hover{background:color-mix(in oklab, var(--app-surface, #ffffff), black 6%)}
.more{position:relative}
.menu{position:absolute;right:0;top:calc(100% + 8px);min-width:180px;background:#fff;border:1px solid color-mix(in oklab, #ffffff, black 14%);border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.16);padding:6px;z-index:9999}
.menu.open-up{top:auto;bottom:calc(100% + 8px)}
.menu[hidden]{display:none}
.menu-item{display:flex;width:100%;text-align:left;gap:8px;align-items:center;border:none;background:transparent;padding:8px 10px;border-radius:8px;color:#0f172a;cursor:pointer}
.menu-item:hover{background:color-mix(in oklab, #ffffff, black 6%)}

/* Status colors on timeline bullets */
.task.is-done::before{background:var(--app-ok); box-shadow:0 0 0 6px color-mix(in oklab, var(--app-ok), transparent 85%)}
.task.is-missed::before{background:var(--app-danger); box-shadow:0 0 0 6px color-mix(in oklab, var(--app-danger), transparent 85%)}
.task.is-pending::before{background:var(--app-warn); box-shadow:0 0 0 6px color-mix(in oklab, var(--app-warn), transparent 85%)}
.chip{font-size:.8rem;padding:4px 8px;border-radius:999px;background:color-mix(in oklab, var(--app-surface, #ffffff), black 6%);color:var(--app-muted)}
.status-done{background:color-mix(in oklab, var(--app-ok), transparent 70%);color:#bff0d9}
.status-missed{background:color-mix(in oklab, var(--app-danger), transparent 75%);color:#ffd0d0}
.status-pending{background:color-mix(in oklab, var(--app-warn), transparent 75%);color:#ffe6b8}
.task.is-done{background:linear-gradient(180deg, color-mix(in oklab, #3ccf91, transparent 94%), #fff); border-left-color:#3ccf91}
.task.is-missed{background:linear-gradient(180deg, color-mix(in oklab, #ff5d5d, transparent 94%), #fff); border-left-color:#ff5d5d}
.task.is-pending{background:linear-gradient(180deg, color-mix(in oklab, #ffcc66, transparent 94%), #fff); border-left-color:#ffcc66}

/* Completed list styling */
.task-list--completed .task{opacity:.95}
.task-list--completed .task-title{text-decoration:line-through;color:color-mix(in oklab, var(--text, #0f172a), black 18%)}

/* Completed section persistent glow */
#completed-sub.glow-section{animation: section-glow 8s ease-in-out infinite}
@keyframes section-glow{ 0%{box-shadow:0 0 0 rgba(139,92,246,.0)} 50%{box-shadow:0 12px 40px rgba(34,211,238,.16)} 100%{box-shadow:0 0 0 rgba(139,92,246,.0)} }

.achievement{position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.45);backdrop-filter:blur(6px);}
.achievement[hidden]{display:none}
.ach-card{background:linear-gradient(180deg, #ffffff, #f7f9ff);border:1px solid color-mix(in oklab, #ffffff, black 12%);box-shadow:var(--app-shadow);color:#0f172a;
  padding:30px;border-radius:16px;text-align:center;max-width:420px}
.ach-card .trophy{font-size:54px;margin-bottom:8px}

.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:#ffffff;color:#0f172a;border:1px solid color-mix(in oklab, #ffffff, black 16%);padding:12px 14px;border-radius:12px;
  box-shadow:var(--app-shadow);display:flex;gap:12px;align-items:center;z-index:10000}
.toast[hidden]{display:none}
.toast-actions{display:flex;gap:8px}

/* Centered variant for important notices */
.toast.center{top:50%;bottom:auto;transform:translate(-50%,-50%)}
.toast.task{min-width:420px;max-width:min(90vw,560px);padding:18px 20px;border-radius:16px;font-size:1.05rem}

.dialog{position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.45);backdrop-filter:blur(6px)}
.dialog[hidden]{display:none}
.dialog-card{background:linear-gradient(180deg, #ffffff, #f7f9ff);border:1px solid color-mix(in oklab, #ffffff, black 12%);box-shadow:var(--app-shadow);color:#0f172a;
  padding:20px;border-radius:16px;max-width:480px;width:92%}
.dialog-actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;margin-top:12px}

.visually-hidden{position:absolute!important;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}

/* Confetti bits */
#confetti{position:absolute;inset:0;overflow:hidden;pointer-events:none}
.confetti{position:absolute;width:10px;height:16px;opacity:.9;will-change:transform, opacity}
@keyframes fall { to { transform: translateY(110vh) rotate(720deg); opacity: .8; } }

/* Responsive tweaks */
@media (max-width: 720px){
  .task{grid-template-columns:1fr;align-items:flex-start}
  .task-time{min-width:auto}
  .field.two-col{grid-template-columns:1fr}
}

/* Brand position tweak (move icon/name down-left) */
.topbar .app-brand { transform: translate(12px, 8px); }


/* Compact time dropdown */
.time-dropdown{position:fixed;z-index:100000;max-height:180px;overflow:auto;min-width:120px;background:#fff;border:1px solid color-mix(in oklab,#ffffff,black 14%);border-radius:10px;box-shadow:0 12px 30px rgba(0,0,0,.16);padding:6px}
.time-dropdown button{display:block;width:100%;text-align:left;border:none;background:transparent;padding:6px 8px;border-radius:8px;font:inherit;color:#0f172a;cursor:pointer}
.time-dropdown button:hover,.time-dropdown button[aria-selected="true"]{background:color-mix(in oklab,#ffffff,black 6%)}

/* Kebab menu: fit to content and prevent viewport fill */
.menu{ right:auto; left:auto; top:auto; bottom:auto; position:fixed; width:max-content; min-width:unset; max-width:min(240px, 90vw); white-space:nowrap; }
.menu.open-up{ bottom:auto; }

/* Calendar -------------------------------------------------------------- */
.calendar{margin-top:10px}
.cal-month{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.cal-weekday{font-size:.8rem;color:var(--app-muted);text-align:center;padding:4px 0}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.cal-cell{position:relative;appearance:none;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);
  background:color-mix(in oklab, var(--app-surface,#fff), black 2%);border-radius:10px;padding:8px 10px;text-align:right;cursor:pointer;min-height:44px}
.cal-cell:hover{background:color-mix(in oklab, var(--app-surface,#fff), black 6%)}
.cal-cell.is-outside{opacity:.55}
.cal-cell.is-today{outline:2px solid color-mix(in oklab, var(--app-primary), transparent 40%)}
.cal-cell.is-selected{border-color:color-mix(in oklab, var(--app-primary), transparent 35%);box-shadow:0 6px 18px rgba(0,0,0,.08)}
.cal-cell .cal-num{font-weight:600}
.cal-cell.has-tasks::after{content:"";position:absolute;left:10px;bottom:8px;width:8px;height:8px;border-radius:50%;background:var(--app-primary)}
.cal-week{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.cal-day{position:relative;appearance:none;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);
  background:color-mix(in oklab, var(--app-surface,#fff), black 2%);border-radius:10px;padding:10px;cursor:pointer;text-align:center}
.cal-day:hover{background:color-mix(in oklab, var(--app-surface,#fff), black 6%)}
.cal-day.is-today{outline:2px solid color-mix(in oklab, var(--app-primary), transparent 40%)}
.cal-day.is-selected{border-color:color-mix(in oklab, var(--app-primary), transparent 35%);box-shadow:0 6px 18px rgba(0,0,0,.08)}
.cal-year{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.cal-month-btn{appearance:none;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);background:color-mix(in oklab, var(--app-surface,#fff), black 2%);
  border-radius:12px;padding:14px;cursor:pointer;text-align:center}
.cal-month-btn:hover{background:color-mix(in oklab, var(--app-surface,#fff), black 6%)}

/* Header layout adjustments for Calendar and History */
#calendar-card .list-header,
#history-section .list-header{ justify-content:space-between; flex-wrap:wrap; gap:12px }
#calendar-card .list-controls,
#history-section .list-controls{ display:flex; flex-wrap:wrap; align-items:center; gap:12px }
#calendar-card .cal-controls{ display:flex; flex-wrap:wrap; align-items:center; gap:12px }

/* Larger, rounded dropdowns for Calendar/History */
#cal-view, #history-range{
  appearance:auto;
  padding:10px 14px;
  font-size:1rem;
  border-radius:14px;
  border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 12%);
  background:color-mix(in oklab, var(--app-surface,#fff), black 2%);
  color:var(--text,#0f172a);
  box-shadow:0 6px 18px rgba(0,0,0,.04);
}
#cal-view:hover, #history-range:hover{ background:color-mix(in oklab, var(--app-surface,#fff), black 6%) }

/* Segmented buttons (bigger, button-like) */
.seg{display:inline-flex;border:1px solid color-mix(in oklab, var(--app-surface,#fff), black 14%);border-radius:14px;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,.04)}
.seg-btn{appearance:none;border:none;background:transparent;padding:10px 16px;font:600 0.95rem/1 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text,#0f172a);cursor:pointer}
.seg-btn:hover{background:color-mix(in oklab, var(--app-surface,#fff), black 6%)}
.seg-btn.active{background:linear-gradient(180deg, var(--app-primary), var(--app-primary-2));color:#fff}
.seg-btn + .seg-btn{border-left:1px solid color-mix(in oklab, var(--app-surface,#fff), black 10%)}
